import{_ as t,o as s,c as a,U as e}from"./chunks/framework.3eb667f5.js";const b=JSON.parse('{"title":"The Accounts Schema","description":"","frontmatter":{"outline":[2,3]},"headers":[],"relativePath":"docs/onboarding/database/schemas/accounts.md"}'),o={name:"docs/onboarding/database/schemas/accounts.md"},n=e('<h1 id="the-accounts-schema" tabindex="-1">The <span class="schema-table">Accounts</span> Schema <a class="header-anchor" href="#the-accounts-schema" aria-label="Permalink to &quot;The &lt;span class=&quot;schema-table&quot;&gt;Accounts&lt;/span&gt; Schema&quot;">​</a></h1><p>This schema contains all the information related to the Users and Entities of the platform and their permissions and relations. We will prefix the schema&#39;s name on every table to avoid confusion. We are going to use a <span style="color:#888;">gray</span> color to define the name of the schema.</p><p>To standardize the aliases used on all the application queries, we will add the preferred alias of every table based on the expected use convention by most developers. The usual name convection uses the schema&#39;s first letter and the visited table&#39;s first letter.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Masked Information</p><ul><li>All Account&#39;s emails have been masked for security.</li><li>All Passwords are hashed.</li></ul></div><p>Let&#39;s review the list of most essential tables in this schema:</p><h2 id="accounts-relations" tabindex="-1">Accounts Relations <a class="header-anchor" href="#accounts-relations" aria-label="Permalink to &quot;Accounts Relations&quot;">​</a></h2><h3 id="accounts-accounts" tabindex="-1"><span style="color:#888;padding-bottom:0;">Accounts.</span>Accounts <a class="header-anchor" href="#accounts-accounts" aria-label="Permalink to &quot;&lt;span style=&quot;color: #888; padding-bottom: 0;&quot;&gt;Accounts.&lt;/span&gt;Accounts&quot;">​</a></h3><p><strong>Alias:</strong> aa</p><p>This table store all the accounts from the system. It&#39;s crucial to understand the structure of this table. If you can see the size of this table, it&#39;s larger than expected; that&#39;s because we have some <em>BLOG</em> columns that store the metadata of images for the user.</p><blockquote><p>Every <strong>Account</strong> belongs to one or more <strong>Offices</strong>.</p></blockquote><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>The <code>defaultRole</code> column contains the <code>id</code> of the <strong>Accounts.Roles</strong> table.</p></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><ul><li>AVOID using * from this table to avoid database overload because of the table size.</li><li>NEVER delete from this table. We use the <code>deactivate</code> column to soft-delete users. We need those users for history.</li><li>ALWAYS use the <code>deactivate</code> column on every query related to this table to validate the user status except in those scenarios that require deactivated users.</li></ul></div><h3 id="accounts-officesaccounts" tabindex="-1"><span class="schema-table">Accounts.</span>OfficesAccounts <a class="header-anchor" href="#accounts-officesaccounts" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;OfficesAccounts&quot;">​</a></h3><p><strong>Alias:</strong> aoa</p><p>This is only a relational table. Office information is stored on the <code>Accounts.Offices</code> table.</p><h3 id="accounts-offices" tabindex="-1"><span class="schema-table">Accounts.</span>Offices <a class="header-anchor" href="#accounts-offices" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;Offices&quot;">​</a></h3><p><strong>Alias:</strong> ao</p><p>This table contains all the Offices information.</p><blockquote><p>Every <strong>Office</strong> belongs to one <strong>Company</strong>.</p></blockquote><h3 id="accounts-companies" tabindex="-1"><span class="schema-table">Accounts.</span>Companies <a class="header-anchor" href="#accounts-companies" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;Companies&quot;">​</a></h3><p><strong>Alias:</strong> ac</p><p>This table contains all the Offices information.</p><blockquote><p>Every <strong>Company</strong> has one or more <strong>Offices</strong>.</p></blockquote><h3 id="accounts-entities" tabindex="-1"><span class="schema-table">Accounts.</span>Entities <a class="header-anchor" href="#accounts-entities" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;Entities&quot;">​</a></h3><p><strong>Alias:</strong> ae</p><p>This is the higher group hierarchy in the application. In the interface of C360, this is called <strong>Organization</strong>, but in the codebase is defined as <strong>Entity</strong>. Entities are essential because there exists business logic specific to Entities. This table is related to the <code>Switch Company</code> feature.</p><blockquote><p>Every <strong>Company</strong> has one or more <strong>Offices</strong>.</p></blockquote><div class="info custom-block"><p class="custom-block-title">INFO</p><p>All the defined tables until now are all the <strong>core</strong> tables for accounts relations.</p></div><h2 id="auxiliary-tables" tabindex="-1">Auxiliary Tables <a class="header-anchor" href="#auxiliary-tables" aria-label="Permalink to &quot;Auxiliary Tables&quot;">​</a></h2><h3 id="accounts-accountdetails" tabindex="-1"><span class="schema-table">Accounts.</span>AccountDetails <a class="header-anchor" href="#accounts-accountdetails" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;AccountDetails&quot;">​</a></h3><p><strong>Alias:</strong> aad</p><p>This table contains extra data related to the account.</p><blockquote><p>Every <strong>Account</strong> has one <strong>Account Detail</strong>.</p></blockquote><blockquote><p>Not all accounts have an Account Detail record.</p></blockquote><h3 id="accounts-accountsettings" tabindex="-1"><span class="schema-table">Accounts.</span>AccountSettings <a class="header-anchor" href="#accounts-accountsettings" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;AccountSettings&quot;">​</a></h3><p><strong>Alias:</strong> aas</p><p>NEED MORE INFORMATION</p><h2 id="accounts-permissions" tabindex="-1">Accounts Permissions <a class="header-anchor" href="#accounts-permissions" aria-label="Permalink to &quot;Accounts Permissions&quot;">​</a></h2><h3 id="accounts-roles" tabindex="-1"><span class="schema-table">Accounts.</span>Roles <a class="header-anchor" href="#accounts-roles" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;Roles&quot;">​</a></h3><p><strong>Alias:</strong> ar</p><p>Contain the information about the User&#39;s Defaults Role in the application.</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><ul><li>AVOID the <code>code</code> column for business logic. Using <code>code</code> can be dangerous.</li><li>Roles abstract permissions. Create business logic by using the Permissions table.</li></ul></div><h3 id="accounts-rolespermissions" tabindex="-1"><span class="schema-table">Accounts.</span>RolesPermissions <a class="header-anchor" href="#accounts-rolespermissions" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;RolesPermissions&quot;">​</a></h3><p><strong>Alias:</strong> arp</p><p>This is only a relational table. Permission information is stored on the <code>Accounts.Permissions</code> table.</p><h3 id="accounts-permissions-1" tabindex="-1"><span class="schema-table">Accounts.</span>Permissions <a class="header-anchor" href="#accounts-permissions-1" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;Permissions&quot;">​</a></h3><p><strong>Alias:</strong> ap</p><p>This is a Reference table with all the existing Permissions for an Account. It includes others attributes about the permissions.</p><blockquote><p>The <code>keepWhenFinal</code> can be confusing. Don&#39;t waste time understanding this until you are related to any issue related to the Final Report.</p></blockquote><blockquote><p>The <code>name</code> column is the one used to compare Roles.</p></blockquote><h3 id="accounts-entityoverseeraccounts" tabindex="-1"><span class="schema-table">Accounts.</span>EntityOverseerAccounts <a class="header-anchor" href="#accounts-entityoverseeraccounts" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;EntityOverseerAccounts&quot;">​</a></h3><p><strong>Alias:</strong> aeoa</p><p>This table store Accounts with the ability to jump between Companies. This ability it&#39;s NOT defined in the <code>Accounts.Permissions</code> table.</p><h3 id="accounts-entityoverseercompanyaccess" tabindex="-1"><span class="schema-table">Accounts.</span>EntityOverseerCompanyAccess <a class="header-anchor" href="#accounts-entityoverseercompanyaccess" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;EntityOverseerCompanyAccess&quot;">​</a></h3><p><strong>Alias:</strong> aeoca</p><p>This table defines limitations to the Account over a defined Company. An Account only has access to the Companies related to this table. If not record related, the Account can access all the Companies of the Entity. This ability it&#39;s NOT defined in the <code>Accounts.Permissions</code> table.</p><h3 id="accounts-entityoverseerofficeaccess" tabindex="-1"><span class="schema-table">Accounts.</span>EntityOverseerOfficeAccess <a class="header-anchor" href="#accounts-entityoverseerofficeaccess" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;EntityOverseerOfficeAccess&quot;">​</a></h3><p><strong>Alias:</strong> aeooa</p><p>This table defines limitations to the Account over a defined Office. An Account only has access to the Offices related to this table. If not record related, the Account can access all the Offices of the Entity. This ability it&#39;s NOT defined in the <code>Accounts.Permissions</code> table.</p><h3 id="accounts-entityroles" tabindex="-1"><span class="schema-table">Accounts.</span>EntityRoles <a class="header-anchor" href="#accounts-entityroles" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;EntityRoles&quot;">​</a></h3><p><strong>Alias:</strong> aer</p><p>An important table. Roles are available at the Entity level. This defines the relation of all the Roles of an Entity. By doing this, the user can define custom permissions per Role.</p><h3 id="accounts-companiesoptions" tabindex="-1"><span class="schema-table">Accounts.</span>CompaniesOptions <a class="header-anchor" href="#accounts-companiesoptions" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;CompaniesOptions&quot;">​</a></h3><p><strong>Alias:</strong> aco</p><p>An important table for business logic. Control a lot of configurations options for a Company.</p><h2 id="audit-tools" tabindex="-1">Audit Tools <a class="header-anchor" href="#audit-tools" aria-label="Permalink to &quot;Audit Tools&quot;">​</a></h2><h3 id="accounts-changelog" tabindex="-1"><span class="schema-table">Accounts.</span>Changelog <a class="header-anchor" href="#accounts-changelog" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;Changelog&quot;">​</a></h3><p><strong>Alias:</strong> acl</p><p>This is an Audit table that stores all the events that occur in the application. This is the main table for forensic investigation.</p><h2 id="from-laravel" tabindex="-1">From Laravel <a class="header-anchor" href="#from-laravel" aria-label="Permalink to &quot;From Laravel&quot;">​</a></h2><h3 id="accounts-sessions" tabindex="-1"><span class="schema-table">Accounts.</span>sessions <a class="header-anchor" href="#accounts-sessions" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;sessions&quot;">​</a></h3><p><strong>Alias:</strong> as</p><p>The default Laravel sessions table. This app uses the Database driver to handle sessions with Laravel.</p><h3 id="accounts-migrations" tabindex="-1"><span class="schema-table">Accounts.</span>migrations <a class="header-anchor" href="#accounts-migrations" aria-label="Permalink to &quot;&lt;span class=&quot;schema-table&quot;&gt;Accounts.&lt;/span&gt;migrations&quot;">​</a></h3><p><strong>Alias:</strong> am</p><p>Laravel&#39;s migration table. This table is different from the default Laravel session because it implements a custom package that allows the handling of metadata to simplify the migration process if needed.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Some fields could be significant because a custom package, Pneumatic Migrations by Chris Harpers, simplify the revert process of migrations if needed.</p></div>',77),c=[n];function i(l,r,u,h,p,d){return s(),a("div",null,c)}const f=t(o,[["render",i]]);export{b as __pageData,f as default};
